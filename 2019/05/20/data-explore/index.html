<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Contents Recap of Parts 1-4 Data Wrangling Exploring the Data Set The Number of Rows and Columns Column Names Null Values Per Column Column Datatypes Bar Graph for Different Property Types Unique...">
        <meta name="keywords" content="matplotlib, pandas, python, tutorial">
        <link rel="icon" href="../../../../favicon.ico">

        <title>End-to-End Data Analysis Project: Part 5. Data Exploration - Sonny's Blog</title>

        <!-- Stylesheets -->
        <link href="../../../../theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../theme/css/fonts.css" rel="stylesheet">
        <link href="../../../../theme/css/nest.css" rel="stylesheet">
        <link href="../../../../theme/css/pygment.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://sonnycruz.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Sonny's Blog Full Atom Feed" />
        <link href="https://sonnycruz.github.io/feeds/python.atom.xml" type="application/atom+xml" rel="alternate" title="Sonny's Blog Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('../../../../images/art-artistic-background-247676.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="../../../../"><img class="mr20" src="../../../../images/blank.png" alt="logo">Sonny's Blog</a>
                    </div>
                    <div class="nav pull-right">
                            <a  href="../../../../pages/about-me.html">About Me</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">End-to-End Data Analysis Project: Part 5. Data Exploration</h1>
                      <p class="header-date"> <a href="../../../../author/sonny-torres.html">Sonny Torres</a>, Mon 20 May 2019,  <a href="../../../../category/python.html">Python</a></p>
                      <div class="header-underline"></div>
                      <div class="clearfix"></div>
                      <p class="pull-right header-tags">
                          <span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="../../../../tag/matplotlib.html">matplotlib</a>, <a href="../../../../tag/pandas.html">pandas</a>, <a href="../../../../tag/python.html">python</a>, <a href="../../../../tag/tutorial.html">tutorial</a>                      </p>
                  </div>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="container content">
        <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#recap-of-parts-1-4-data-wrangling" id="id9"><strong>Recap of Parts 1-4 Data Wrangling</strong></a></li>
<li><a class="reference internal" href="#exploring-the-data-set" id="id10"><strong>Exploring the Data Set</strong></a></li>
<li><a class="reference internal" href="#the-number-of-rows-and-columns" id="id11"><strong>The Number of Rows and Columns</strong></a></li>
<li><a class="reference internal" href="#column-names" id="id12"><strong>Column Names</strong></a></li>
<li><a class="reference internal" href="#null-values-per-column" id="id13"><strong>Null Values Per Column</strong></a></li>
<li><a class="reference internal" href="#column-datatypes" id="id14"><strong>Column Datatypes</strong></a></li>
<li><a class="reference internal" href="#bar-graph-for-different-property-types" id="id15"><strong>Bar Graph for Different Property Types</strong></a></li>
<li><a class="reference internal" href="#unique-keys-and-merging-data-sets" id="id16"><strong>Unique Keys and Merging Data Sets</strong></a></li>
<li><a class="reference internal" href="#loan-vs-property" id="id17"><strong>Loan vs. Property</strong></a></li>
<li><a class="reference internal" href="#other-basic-descriptive-statistics" id="id18"><strong>Other Basic Descriptive Statistics</strong></a></li>
<li><a class="reference internal" href="#in-closing" id="id19"><strong>In Closing</strong></a></li>
<li><a class="reference internal" href="#footnotes" id="id20"><strong>Footnotes</strong></a></li>
</ul>
</div>
<div class="section" id="recap-of-parts-1-4-data-wrangling">
<h2><a class="toc-backref" href="#id9"><strong>Recap of Parts 1-4 Data Wrangling</strong></a></h2>
<p>I started this &quot;End-to-End Data Analysis Project&quot; in order to practice and document my programming skills with Python. Unlike many other blog posts, this series does <em>not</em> center around an easily acquired data set. In fact, all 4 blog posts preceding this one have covered <em>just</em> the gathering and formatting of the data <a class="footnote-reference" href="#id5" id="id1">[1]</a>. Below is a recap of the previous 4 blog posts.</p>
<ol class="arabic simple">
<li><a class="reference external" href="../../../../2018/12/23/Getting-Data/">Part 1 Getting Data</a>: I didn't want to begin my blog with what I felt were &quot;training wheels&quot;, like a data set that was acquired by manually copying and pasting. I also didn't want a commonly used &quot;toy&quot; data set that many others have used in other blog posts. I wanted the data set to be gathered from scratch! But most importantly, I couldn't use and publish the data I work with at my job because it is proprietary. So, I created a script to scrape a publicly available HTML file containing similar data <a class="footnote-reference" href="#id6" id="id2">[2]</a>. To gather the data, I used <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">BeautifulSoup</a> and <a class="reference external" href="https://docs.python.org/3.7/library/re.html">Regular Expressions</a> to scrape and organize various tables of CMBS loan data from an HTML file downloaded from this <a class="reference external" href="https://www.sec.gov/Archives/edgar/data/1013611/000152153611000217/q1100154_fwpa1-jpm.htm">SEC webpage</a>. <em>Writing the code for this post was extremely challenging!</em></li>
<li><a class="reference external" href="../../../../2019/04/18/Parse-Headers/">Part 2 Parsing the Headers</a>: In order to combine multiple header rows that were spread across multiple CSV files, I had to load each header file, account for encoding differences between Python and the data source, account for duplicate header values, join a hierarchal index of header rows into a single header row and then save and concatenate the results.</li>
<li><a class="reference external" href="../../../../2019/04/23/Join-Stack/">Part 3 Join and Stack</a>: The table data was joined and stacked horizontally and vertically to piece together the puzzle of data tables first explained in Part 1: Getting Data. Finally, the parsed header row was stacked on to the table data.</li>
<li><a class="reference external" href="../../../../2019/05/04/More-Cleanup/">Part 4 More Cleanup</a>:  Here, I got rid of annoying symbols and characters in the headers, deleted columns which contained all NA values and deleted duplicate columns (the repeated indices for each table on the web page).</li>
</ol>
<p>Again, the source code for each post can be found <a class="reference external" href="https://github.com/sonnycruz/End-to-End-Data-Analysis">in my Github</a> account.</p>
<p>Now, the data is one uniform file and is easy to manage. Below I will walk through some common data exploration techniques I use to understand a data set.</p>
</div>
<div class="section" id="exploring-the-data-set">
<h2><a class="toc-backref" href="#id10"><strong>Exploring the Data Set</strong></a></h2>
<p>When exploring a data set I like to use an <a class="reference external" href="https://en.wikipedia.org/wiki/Interpreter_(computing)">interpreter</a> and interact with the data in real-time. I used the IPython command shell to develop the code for this post, and appropriately the code for this section is meant to be typed at a Python interpreter, otherwise you will have to use <tt class="docutils literal"><span class="pre">print([code])</span></tt>.</p>
<p>Below are the imports. I modified some visual settings for Pandas to view more output in the interpreter.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span> <span class="k">as</span> <span class="n">NA</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\Username\Desktop\End-to-End-Data-Analysis\1. Get the Data\table&#39;</span>
<span class="nb">file</span> <span class="o">=</span> <span class="s1">&#39;CMBS New Final.csv&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="nb">file</span><span class="p">),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
</pre></div>
<p>First, you can assess the general quality of the data by using the <tt class="docutils literal">.head()</tt> method in a Python interpreter.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<img alt="df head4" src="/images/dfhead4.PNG" />
<p>Next, there are four fundamental characteristics I like to see for every data set.</p>
<ol class="arabic simple">
<li>The number of columns and rows.</li>
<li>The name of each column.</li>
<li>The number of null values for each column.</li>
<li>The datatypes of each column.</li>
</ol>
</div>
<div class="section" id="the-number-of-rows-and-columns">
<h2><a class="toc-backref" href="#id11"><strong>The Number of Rows and Columns</strong></a></h2>
<p>You can access the Pandas' <tt class="docutils literal">.shape</tt> attribute and you will see a tuple containing the rows and columns in the format (rows, columns).</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
<img alt="dfshape3" src="/images/row_col_count.JPG" style="width: 25%;" />
<p>or you can call the <tt class="docutils literal">df.info()</tt> method to get a little more information, such as memory usuage.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
<img alt="df info" src="/images/info_two.JPG" style="width: 45%;" />
</div>
<div class="section" id="column-names">
<h2><a class="toc-backref" href="#id12"><strong>Column Names</strong></a></h2>
<p>In my experience with working with Pandas, indexing by column names is one of the most common operations. For example, I may index column names to change a column's data type, combine columns, merge data sets, rename columns or produce aggregate statistics. Below is one way to see all of the columns for a data set.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
<img alt="dfcolval" src="/images/dfcolval.PNG" style="width: 85%;" />
<p>However, recently I have preferred to save all of the column names to a text file.</p>
<div class="highlight"><pre><span></span><span class="n">indx_cols</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">tupl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
      <span class="n">indx</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">tupl</span>
      <span class="n">indx_cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">col</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;cmbs cols.txt&quot;</span><span class="p">,</span> <span class="n">indx_cols</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
<p>Above, the empty list <tt class="docutils literal">indx_cols</tt> is the data container which will contain all of the column information.</p>
<p>I then iterated over each tuple that <tt class="docutils literal">enumerate</tt> produces when passed <tt class="docutils literal">df.columns.values</tt>.</p>
<p>The index values and column names are then appended to the list <tt class="docutils literal">indx_cols</tt>.</p>
<p><tt class="docutils literal">np.savetxt</tt> then saves a text file with each column index number and column name, below.</p>
<img alt="cmbs_cols_txt_file_two" src="/images/cmbs_cols_two.JPG" />
<p>This way, you have a text file to refer to where you can highlight and copy/paste values when you are writing code that involves indexing long column names or, in this case, when there are 100+ columns to work with.</p>
</div>
<div class="section" id="null-values-per-column">
<h2><a class="toc-backref" href="#id13"><strong>Null Values Per Column</strong></a></h2>
<p>This particular data set has many null values and because I wanted to gather descriptive statistics on columns that consider each data point, it is useful to know how many data points and missing data points (null values) there are per column. For example, a median or average value for a given column of data is not so relevant when only 20% of the data is not null.</p>
<p>But first, I wanted to change the encoding (<a class="reference external" href="../../../../2019/04/23/Join-Stack/">covered in this post</a>) to make sure that the null values showed up at all. I was reminded that I needed to encode these values to UTF-8 when I saw that there were <em>NO null values</em>, which you can easily see is incorrect when opening the file in Excel. The null values were just read by Python (UTF-8 encoding) as string values that look like this: <tt class="docutils literal">'\xa0 '</tt>. I could just replace these strange looking string values with NA values, but I prefer to convert to Python's native encoding to avoid any other issues.</p>
<p>Below will convert the the <a class="reference external" href="https://en.wikipedia.org/wiki/Windows-1252">Windows-1252 or CP-1252</a> encoded data set into UTF-8 encoding, column by column. I used portions of code from a really cool blog written by Josh Devlin, on making Pandas Dataframes more memory efficient, which you can <a class="reference external" href="https://www.dataquest.io/blog/pandas-big-data/">check out here</a>.</p>
<div class="highlight"><pre><span></span><span class="n">str_dtypes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span>
<span class="n">utf_encoded</span> <span class="o">=</span> <span class="n">str_dtypes</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s1">&#39;NFKD&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">utf_encoded</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span> <span class="o">=</span> <span class="n">utf_encoded</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;  &#39;</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>First, in order to target <em>just the columns with string values</em> (in Python 'everything is an object', but this method is referring to strings with the keyword ''object'') and not the columns of numerical data types, I used the <tt class="docutils literal">.select_dtypes</tt> Pandas dataframe method. I select only the string columns because using <tt class="docutils literal">.apply</tt> on a Dataframe with a lambda function that is meant for only strings actually converts the numerical column to all null values.</p>
<p>Next, I used Pandas' <tt class="docutils literal">.apply</tt> method and passed a lambda function where every <tt class="docutils literal">x</tt> is a column that will have its <tt class="docutils literal">.str.</tt> attribute accessed and the <tt class="docutils literal">normalize</tt> method is used to convert the non-break space character into its correct character representation, a string value consisting of 3 spaces.</p>
<p>Because I want these non-break space characters to show up as blanks, or null values, I call <tt class="docutils literal">df.replace</tt> so the string value <tt class="docutils literal">'&nbsp;&nbsp; '</tt> is replaced with null values.</p>
<p>Now, I can call <tt class="docutils literal">df.count()</tt> and see how many non-null values there are in each column. Or, rather than viewing the raw number of values that are valid values per row, you can view the <em>percentage</em> of values that are present in each column using the code below.</p>
<div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
<img alt="non_null" src="/images/pct_not_null0.JPG" style="width: 75%;" />
</div>
<div class="section" id="column-datatypes">
<h2><a class="toc-backref" href="#id14"><strong>Column Datatypes</strong></a></h2>
<p>Below is a convenient way to see what each column's datatype is.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
<p>and a thumbnail of the results from my Jupter Notebook, below.</p>
<img alt="dtype_preview" src="/images/dtypes_obj_two.JPG" style="width: 75%;" />
<p>Working with financial data, one of the most common datatype conversions I do is converting dollars and dates to usable, sortable data types. Below are two functions that I created to use for this purpose.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">currency</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
      <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[$,()%]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">date_convert</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
      <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
<p>Notice that the <tt class="docutils literal">currency</tt> function will not only replace dollar symbols, parentheses and commas with empty strings but also the percent symbol - another symbol often seen in business and finance <a class="footnote-reference" href="#id7" id="id3">[3]</a>. See the documentation for Pandas' <tt class="docutils literal">.replace</tt> method <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.replace.html">at this link</a> and the <tt class="docutils literal">pd.to_datetime</tt> <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">documentation</a>.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Current Balance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<img alt="dollars" src="/images/before_money.JPG" style="width: 60%;" />
<div class="highlight"><pre><span></span><span class="n">currency</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Current Balance&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Current Balance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<img alt="dollar_after" src="/images/after_money.JPG" style="width: 60%;" />
<p>The <tt class="docutils literal">date_convert</tt> function is just convenient shorthand for the Pandas' <tt class="docutils literal">pd.to_datetime</tt> method. Surprisingly, the parameter and argument <tt class="docutils literal">infer_datetime_format=True</tt> speeds up an otherwise lengthy conversion process (i.e. '5/26/2018' a string, is converted to 2018-05-26, a sortable date).</p>
<p>See the documentation for Pandas' <tt class="docutils literal">.to_datetime</tt> method <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html">click here</a>.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Final Mat Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<img alt="date_obj" src="/images/before_date_two.JPG" style="width: 65%;" />
<div class="highlight"><pre><span></span><span class="n">date_convert</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Final Mat Date&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Final Mat Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<img alt="date_type" src="/images/date_after.JPG" style="width: 65%;" />
<p>Another Metric I will look at is DSCR, Net Operating Income for a given period, divided by the total debt service due for that period.</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;UW NOI DSCR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;UW NOI DSCR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="bar-graph-for-different-property-types">
<h2><a class="toc-backref" href="#id15"><strong>Bar Graph for Different Property Types</strong></a></h2>
<p>After assessing the basic characteristics of the data, I try to produce simple visualizations to gain a more intuitive understanding of the data. For example, a histogram representing a distribution of values for some category of data.</p>
<p><a class="reference external" href="https://matplotlib.org/3.1.0/index.html">Matplotlib</a>, Python's primary graphing library, has relatively low-level syntax compared to the main Python library. Creating a graph and customizing the graph can require many lines of code, each instructing a small change such as the color of a chart, formatting an axes to percent or rotating labels.</p>
<p>To make things more complicated, Matplotlib tutorials often look vastly different for similar operations. This is due to the fact that the library has two different interfaces. Data Scientist Jake Vanderplas artfully <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/04.00-introduction-to-matplotlib.html#Two-Interfaces-for-the-Price-of-One">described</a> how Matplotlib has a quick MATLAB-style interface <em>and</em> an object-oriented interface for more customizable graphs. I prefer to use the Object-Oriented interface.</p>
<p>The method of experimentation with Matplotlib that I found the most helpful was using the IPython shell coupled with its magic command <tt class="docutils literal">%matplotlib</tt>, so that I could see the changes to the graph in real time as I tinkered with different presentation details. See the <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html">Magic Commands</a> documentation.</p>
<p>Because it often took me many lines of code to produce a basic bar chart, I created a function with parameters that produces a customizable bar chart from a dictionary of data.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cmbs_bars</span><span class="p">(</span><span class="n">dict_data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ylim_low</span><span class="p">,</span> <span class="n">ylim_high</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">y_thousands</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
              <span class="n">text_message</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text_c1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">text_c2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;seaborn-bright&#39;</span><span class="p">,</span>
              <span class="n">bar_color</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">xtick_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xtick_font</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">,</span>
              <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">grid_line_style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">grid_line_width</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span>
              <span class="n">grid_color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">):</span>

      <span class="n">data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
      <span class="n">data_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
      <span class="n">data_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_keys</span><span class="p">))</span>
      <span class="n">data_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
      <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
      <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">data_index</span><span class="p">,</span> <span class="n">data_values</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_color</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">data_index</span><span class="p">,</span> <span class="n">data_keys</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">xtick_rotation</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="n">xtick_font</span><span class="p">)</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim_low</span><span class="p">,</span> <span class="n">ylim_high</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_c1</span><span class="p">,</span> <span class="n">text_c2</span><span class="p">,</span> <span class="n">text_message</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">facecolor</span><span class="p">)</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="n">grid_line_style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">grid_line_width</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="n">grid_color</span><span class="p">)</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">y_thousands</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="p">:</span> <span class="s2">&quot;{:,}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p>Above, are the 24 lines of code that can be called to construct a bar chart from a dictionary of data. Does the function look extremely complicated and have a <strong>ridiculous amount of parameters?</strong> Yes, however only 5 of the parameters are <em>required</em>, and I would rather compromise with a cumbersome function with 5 required parameters, than have to write 24 lines of code with 800 characters to produce the graph I want. I summarized the matplotlib syntax and functions in the footnotes at the bottom of this post <a class="footnote-reference" href="#id8" id="id4">[4]</a> but I will summarize what the function is doing below.</p>
<p>In short, unlike using the graphing tool in Excel where you can choose from a series of templates and drop-down menus, Matplotlib requires the user to use specific commands to construct a graph <em>one basic characteristic at a time</em>. For example:</p>
<ol class="arabic simple">
<li><tt class="docutils literal">plt.figure</tt> instantiates the figure object (a grey, blank square).</li>
<li><tt class="docutils literal">fig.add_subplot</tt> creates a subplot (a blank white square with a Y &amp; X axis) inside the figure object.</li>
<li><tt class="docutils literal">ax1.bar</tt> creates a bar graph within the subplot.</li>
</ol>
<p>Most of the remaining parameters in the function <tt class="docutils literal">cmbs_bars()</tt> are for minor aesthetic changes to the graph. See documentation for function.</p>
<p>Below is a dictionary of property types that is then passed to the function <tt class="docutils literal">cmbs_bars</tt>.</p>
<div class="highlight"><pre><span></span><span class="n">prop_dict</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Property Type&#39;</span><span class="p">)[</span><span class="s1">&#39;Number of Properties&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>
<p>The simple use of the <tt class="docutils literal">.groupby()</tt> method above represents a small fraction of the kind data filtering operations that are possible with Pandas' <tt class="docutils literal">.groupby()</tt> method. More on the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">Group By Method in the Pandas Documentation</a>.</p>
<p>And the dictionary values below:</p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;Hotel&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
 <span class="s1">&#39;Manufactured Housing&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;Mixed Use&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
 <span class="s1">&#39;Multifamily&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;Office&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
 <span class="s1">&#39;Retail&#39;</span><span class="p">:</span> <span class="mi">180</span><span class="p">,</span>
 <span class="s1">&#39;Self Storage&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
<p>Passing this dictionary to the function below...</p>
<div class="highlight"><pre><span></span><span class="n">cmbs_bars</span><span class="p">(</span><span class="n">dict_data</span><span class="o">=</span><span class="n">prop_dict</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Number of Properties by Property Type&#39;</span><span class="p">,</span> <span class="n">ylim_low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
          <span class="n">ylim_high</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Number of Properties&#39;</span><span class="p">,</span> <span class="n">xtick_rotation</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">xtick_font</span><span class="o">=</span><span class="mf">8.5</span><span class="p">)</span>
</pre></div>
<p>produces the following graph...</p>
<img alt="prop_type_graph_three" src="/images/prop_types_three.png" style="width: 100%;" />
<p>There are of course other graphing libraries. Basemap is a graphing library that requires a given set of coordinates, 3 shapefiles and returns a geographic map with the coordinate data plotted on the map based on a given coordinate system.</p>
<p>Below is a graph I made some time ago with the Basemap library:</p>
<img alt="first_cmbs" src="/images/second_all_cmbs_map.png" />
<p>The map above is good example of how a large group of location data can be clearly presented in a way that highlights the underlying characteristic of the data, in this case - the disparity in the concentration of CMBS properties in various regions of the United States. Most notably, the northeast has a heavy concentration of CMBS propeties, as well as areas of Texas, California and Florida. There is far less CMBS exposure in states like North and South Dakota, Montana and Nebraska.</p>
</div>
<div class="section" id="unique-keys-and-merging-data-sets">
<h2><a class="toc-backref" href="#id16"><strong>Unique Keys and Merging Data Sets</strong></a></h2>
<p>When merging different data sets or filtering a data set to work with a subset of the data, an important index or key I have learned to be aware of are a data set's unique row or record identifier. What column or columns uniquely, meaning the values do not repeat in any other row, demarcate a given row? For the CMBS data that I use, the key is actually two columns; &quot;Deal ID&quot; and the &quot;Prospectus ID&quot;. When coupled or grouped together these two attributes distinguish every row from all the others. <strong>Three years ago, I thought writing complex INDEX/MATCH formulas in excel would suffice for what I wanted to do but as the data sets grew, so did the memory usuage and the time to write the formulas.</strong> Finally in 2017 I found Pandas' <tt class="docutils literal">pd.merge</tt> method and it is the perfect tool for easily merging data sets. Below is a simplified summary of how I use this method in Python.</p>
<div class="highlight"><pre><span></span><span class="c1"># df_left is the main data set</span>
<span class="n">df_left</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="c1"># df_right is a large data set that has some relevant information that you want joined to df_left.</span>
<span class="n">df_right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># Because df_left is the main data set, the parameter &#39;how&#39; is set to &#39;left&#39;.</span>
<span class="c1"># Also, because df_left and df_right both have the &#39;Deal ID&#39; and &#39;Loan Prospectus ID&#39; columns in common, they can be joined on these columns.</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_left</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Deal ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Loan Prospectus ID&#39;</span><span class="p">])</span>
</pre></div>
<p>In the hypothetical example above, the two data sets are now merged. df_left would now have all the df_right data that had matching 'Deal ID' and 'Loan Prospectus ID' values to the values in df_left.</p>
</div>
<div class="section" id="loan-vs-property">
<h2><a class="toc-backref" href="#id17"><strong>Loan vs. Property</strong></a></h2>
<p>A single loan can be backed by multiple commercial properties. If a loan is backed by more than one property, the loan is listed first, followed by the properties that are the collateral for the loan. In order to extract information about the <em>loans</em>, a subset of the data which does not include property information for loans backed by more than one property, I created a simple but effective filtering mechanism using Pandas' string method <tt class="docutils literal">.endswith()</tt> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.endswith.html">documentation here</a>). <tt class="docutils literal">.endswith()</tt> does not accept a Regular Expression object, rather, it is used for simple match cases like the one below:</p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loan Count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">loans</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Loan Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),:]</span>
</pre></div>
<p>Now, any aggregate statistic such as a the sum of all values in a column, will reflect only the loan-level detail.</p>
</div>
<div class="section" id="other-basic-descriptive-statistics">
<h2><a class="toc-backref" href="#id18"><strong>Other Basic Descriptive Statistics</strong></a></h2>
<p>The dataframe <tt class="docutils literal">loans</tt> contains all the information for the 44 loans in the pool but intentionally excludes property-level detail if there are more than one property. Below is a function I made to give an example of a function which accepts a dataframe and outputs fundamental statistics to describe the data. Basically, the function below <tt class="docutils literal">cmbs_stats()</tt> is like the native Python function I used earlier, <tt class="docutils literal">.describe()</tt>, the difference here being that <tt class="docutils literal">cmbs_stats()</tt> contextualizes the data with instructions to produce domain related measurements and benchmarks such as risk and return variability and property type related information.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cmbs_stats</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
      <span class="n">num_loans</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">num_props</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Number of Properties&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
      <span class="n">prop_type_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Property Type&#39;</span><span class="p">)[</span><span class="s1">&#39;Number of Properties&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
      <span class="n">prop_dist</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">prop_type_count</span> <span class="o">/</span> <span class="n">num_props</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
      <span class="n">dsc_describe</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;UW NOI DSCR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">])</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of Loans: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num_loans</span><span class="p">)))</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number of Properties: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num_props</span><span class="p">)))</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Percentage of Properties by Property Type:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">prop_dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Total Loan Balance of Pool: </span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Current Balance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
      <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s2">&quot;UW NOI DSCR: </span><span class="se">\n</span><span class="s2">{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dsc_describe</span><span class="p">))</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="n">cmbs_stats</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">loans</span><span class="p">)</span>
</pre></div>
<img alt="stat_out" src="/images/get_stat_output.JPG" style="width: 45%;" />
</div>
<div class="section" id="in-closing">
<h2><a class="toc-backref" href="#id19"><strong>In Closing</strong></a></h2>
<p>I have learned so much in 2.5 years of computer coding with Python and I am barely scratching the surface of what is possible! I am excited to start learning Javascript next. Happy coding, everyone!</p>
<p>Again, please feel free to email me with any comments/questions: <a class="reference external" href="mailto:sonnycruztorres&#64;gmail.com">sonnycruztorres&#64;gmail.com</a></p>
<p>Thanks!</p>
</div>
<div class="section" id="footnotes">
<h2><a class="toc-backref" href="#id20"><strong>Footnotes</strong></a></h2>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">There is an axiom that states that 80% of a Data Scientist's time is spent acquiring, cleaning and preparing data. I believe this <a class="reference external" href="https://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/#66511b2c6f63">Forbes article</a> and the survey cited in the article, is the main source of this propagated rule of thumb. I am not a Data Scientist and this is not a Machine Learning project but given my experience with working with data, the 80% rule seems plausible and in some cases, like this project, the data acquisition and cleaning stage is more like 90-95% of the entire project.</p>
<p class="last">It is clear to see that, after 4 blog posts and many lines of code, that acquiring, parsing and joining data can certainly consume the majority of your time when working on a data project. Data preparation is loathed by some and is sometimes, kind of pejoratively, referred to as &quot;janitorial work&quot; (not that there is anything wrong with janitors. I think humans are decades away from producing a robot that can adequately clean a public restroom). However, I have encountered some profoundly complex and thought provoking challenges when working through the aforementioned &quot;janitorial&quot; data preparation stage (my previous 4 blog posts in particular!) and I feel that I have become a better programmer and data analyst for solving these data preparation problems.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Is it worth creating a scraper in the real world? I guess it depends on the time it takes, the quantity and quality of the data and what it is used for.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>For the curious, <a class="reference external" href="https://towardsdatascience.com/5-methods-to-remove-the-from-your-data-in-python-and-the-fastest-one-281489382455">here</a> is a cool article by Chaim Gluck from 2017, written for Towards Data Science, that measures the speed for different methods of converting financial data of type string to usable numbers like floats.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><ul class="first last simple">
<li><tt class="docutils literal">plt.style.use</tt>: <a class="reference external" href="https://matplotlib.org/3.1.0/tutorials/introductory/customizing.html">This method</a> simply chooses an aesthetic palette for the graph.</li>
<li><tt class="docutils literal">plt.figure</tt>: Creates the <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.figure.html">figure object</a> that the graph will be constructed on.</li>
<li><tt class="docutils literal">fig.add_subplot</tt>: Creates a <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure.add_subplot">subplot</a>, assigned to the variable <tt class="docutils literal">ax1</tt>, to the blank figure object. <tt class="docutils literal">111</tt> just means that the subplot is a 1 x 1 (one row, one column) blank plot and is the first (and only) plot. The <tt class="docutils literal">111</tt>'s make less sense when plotting one plot but make sense when constructing a 2 x 2 graph (four empty boxes) and selecting 3, the third box out of the four to edit.</li>
<li><tt class="docutils literal">ax1.bar</tt>: Method to use Matplotlib's <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.bar.html">bar chart</a>.</li>
<li><tt class="docutils literal">plt.xticks</tt>: Allows customization of the X-axis <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.xticks.html">tick</a> marks and labels.</li>
<li><tt class="docutils literal">ax1.set_ylim</tt>: Configures the <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.set_ylim.html">limits</a> for the Y-axis.</li>
<li><tt class="docutils literal">plt.ylabel</tt>: The <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.ylabel.html">Y-axis label</a> such as number of objects.</li>
<li><tt class="docutils literal">plt.text</tt>: Add <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.text.html">text</a> to plot.</li>
<li><tt class="docutils literal">plt.title</tt>: Add <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.title.html">title</a> to plot.</li>
<li><tt class="docutils literal">ax1.set_facecolor</tt>: Sets the <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.set_facecolor.html">facecolor</a> to the axes (subplot).</li>
<li><tt class="docutils literal">ax1.grid</tt>: Configures the plot's <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.pyplot.grid.html">grid lines</a>.</li>
<li><tt class="docutils literal">ax1.set_axisbelow</tt>: Passing True to the function will set the grid lines and tick marks in the <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.set_axisbelow.html">background</a> (behind the bar figures in the graph).</li>
<li><tt class="docutils literal">ax1.get_yaxis.set_major_formatter(plt.FuncFormatter(lambda x, loc: <span class="pre">&quot;{:,}&quot;.format(int(x))))</span></tt>: Selects the <a class="reference external" href="https://matplotlib.org/3.1.0/api/_as_gen/matplotlib.axes.Axes.get_yaxis.html">y axis</a> with <tt class="docutils literal">get_yaxis</tt>, formats the <a class="reference external" href="https://matplotlib.org/3.1.0/gallery/ticks_and_spines/tick-formatters.html">major ticker</a> on the y-axis with <tt class="docutils literal">set_major_formatter</tt>, utilizes <tt class="docutils literal">plt.FuncFormatter</tt> <a class="reference external" href="https://matplotlib.org/3.1.0/api/ticker_api.html#matplotlib.ticker.FuncFormatter">formatting function</a> which then utilizes a lambda function. See more ticker formatting at <a class="reference external" href="https://www.programcreek.com/python/example/100920/matplotlib.ticker.FuncFormatter">Program Creek</a>. The lambda function uses Python's <a class="reference external" href="https://docs.python.org/3.4/library/string.html#format-string-syntax">string formatting syntax</a>.</li>
</ul>
</td></tr>
</tbody>
</table>
</div>



        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                            <li><a href="https://sonnycruz.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"></a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                            <li><a href="" target="_blank"></a></li>
                            <li><a href="#" target="_blank"></a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title"></div>
                        <ul class="list-unstyled">
                            <li><a href="https://www.linkedin.com/in/sonny-torres-6738b780" target="_blank">LinkedIn</a></li>
                            <li><a href="https://github.com/sonnycruz" target="_blank">Github</a></li>
                            <li><a href="https://twitter.com/sonnyctorres" target="_blank">Twitter</a></li>
                            <li><a href="#" target="_blank"></a></li>
                        </ul>
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small></small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>